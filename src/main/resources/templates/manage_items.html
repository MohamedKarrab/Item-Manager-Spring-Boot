<!DOCTYPE html>
<html>
<head>
    <meta charset="ISO-8859-1">
    <title>Manage items</title>
</head>
<body>


<h2>Items List</h2>
<div id="itemsList"></div>
<script src="/js/items-fetch.js"></script>
<h2>Add Item</h2>
<form id="addItemForm">
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" required><br><br>
    <label for="description">Description:</label>
    <input type="text" id="description" name="description" required><br><br>
    <label for="price">Price:</label>
    <input type="number" id="price" name="price" required><br><br>
    <label for="categoryId">Category ID:</label>
    <input type="text" id="categoryId" name="categoryId" required><br><br>
    <button type="submit">Add Item</button>
</form>>
<script>
    document.getElementById('addItemForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Stop the form from submitting normally
        var formData = {
            name: document.getElementById('name').value,
            description: document.getElementById('description').value,
            price: document.getElementById('price').value,
            categoryId: document.getElementById('categoryId').value
        };
        fetch('/api/v1/items', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        }).then(response => response.json())
            .then(data => console.log(data))
            .catch(error => console.error('Error:', error));
    });
</script>



<h2>Update Item</h2>
<form id="updateItemForm">
    <label for="id">Item ID:</label>
    <input type="text" id="update-id" name="id" required><br><br>
    <label for="name">Name:</label>
    <input type="text" id="update-name" name="name"><br><br>
    <label for="description">Description:</label>
    <input type="text" id="update-description" name="description"><br><br>
    <label for="price">Price:</label>
    <input type="number" id="update-price" name="price"><br><br>
    <label for="categoryId">Category ID:</label>
    <input type="text" id="update-categoryId" name="categoryId"><br><br>
    <button type="submit">Update Item</button>
</form>
<script>
    document.getElementById('updateItemForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Stop the form from submitting normally
        var itemId = document.getElementById('update-id').value; // Retrieve the item ID
        var formData = {
            id: document.getElementById('update-id').value,
            name: document.getElementById('update-name').value,
            description: document.getElementById('update-description').value,
            price: document.getElementById('update-price').value,
            categoryId: document.getElementById('update-categoryId').value
        };
        fetch('/api/v1/items/' + itemId, {
            method: 'PUT', // Use PUT method
            headers: {
                'Content-Type': 'application/json', // Set the content type to JSON
            },
            body: JSON.stringify(formData) // Convert the JavaScript object to a JSON string
        }).then(response => response.json())
            .then(data => console.log(data))
            .catch(error => console.error('Error:', error));
    });
</script>


<h2>Delete Item</h2>
<form id="deleteItemForm">
    <label for="delete-id">Item ID:</label>
    <input type="text" id="delete-id" name="id" required><br><br>
    <button type="submit">Delete Item</button>
</form>
<script>
    document.getElementById('deleteItemForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Stop the form from submitting normally
        var itemId = document.getElementById('delete-id').value; // Retrieve the item ID

        if (!itemId) {
            console.error('Item ID is missing');
            return; // Adding this halt further execution if no ID is provided
        }

        fetch(`/api/v1/items/${encodeURIComponent(itemId)}`, {
            method: 'DELETE', // Use DELETE method
        }).then(response => {
            if(response.ok) {
                console.log('Item deleted successfully');
                return response.json();
            } else {
                throw new Error('Failed to delete item');
            }
        }).then(data => console.log(data))
            .catch(error => console.error('Error:', error));
    });
</script>

</body>
</html>